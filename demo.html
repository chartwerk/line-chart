<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">

    <script src="./dist/index.js" type="text/javascript"></script>
  </head>
  <body>
    <div id="chart" style="width: 500px; height: 500px;"></div>

    <script type="text/javascript">
      const startTime = 1590590148;
      const arrayLength = 20;
      const data1 = Array.from({ length: arrayLength }, (el, idx) => [Math.floor(Math.random() * 40), startTime + idx * 10000]);
      const data2 = Array.from({ length: arrayLength }, (el, idx) => [Math.floor(Math.random() * 100), startTime + idx * 10000]);
      const data3 = Array.from({ length: arrayLength }, (el, idx) => [Math.floor(Math.random() * 20) + 90, startTime + idx * 10000]);
      console.log('a');
      var pod = new ChartwerkLineChart(
        document.getElementById('chart'),
        [
          { target: 'test1', datapoints: data1, color: 'green' },
          { target: 'test2', datapoints: data2, color: 'blue' },
           { target: 'test3', datapoints: data3, color: 'orange' },
          // { target: 'test2', datapoints: [[100, 1590590148], [200, 1590692148], [100, 1590794148]], color: 'blue' }
        ],
        { renderLegend: false, usePanning: false, axis: { y: { invert: false, range: [0, 350] }, x: { format: 'time' }} }
      );
      pod.render();
      let rerenderIdx = arrayLength;
      setInterval(() => {
        console.log('rerender');
        rerenderIdx+= 1;
        data1.push([Math.floor(Math.random() * 40), startTime + rerenderIdx * 10000]);
        data2.push([Math.floor(Math.random() * 100), startTime + rerenderIdx * 10000]);
        data3.push([Math.floor(Math.random() * 20) + 90, startTime + rerenderIdx * 10000]);
        if(data1.length > arrayLength) {
          data1.shift();
        }
        if(data2.length > arrayLength) {
          data2.shift();
        }
        if(data3.length > arrayLength) {
          data3.shift();
        }
        pod.render();
      }, 1000);
    </script>
  </body>
</html>
